#
#
play.application.loader = biz.lobachev.annette.attributes.impl.AttributeServiceLoader

# The properties below override Lagom default configuration with the recommended values for new projects.
#
# Lagom has not yet made these settings the defaults for backward-compatibility reasons.

# Prefer 'ddata' over 'persistence' to share cluster sharding state for new projects.
# See https://doc.akka.io/docs/akka/current/cluster-sharding.html#distributed-data-vs-persistence-mode
akka.cluster.sharding.state-store-mode = ddata

# Enable the serializer provided in Akka 2.5.8+ for akka.Done and other internal
# messages to avoid the use of Java serialization.
akka.actor.serialization-bindings {
  "akka.Done" = akka-misc
  "akka.actor.Address" = akka-misc
  "akka.remote.UniqueAddress" = akka-misc
}

elastic {
  url = "https://localhost:9200"
  url = ${?ELASTIC_URL}
  prefix = "dev"
  prefix = ${?ELASTIC_PREFIX}
  username = "admin"
  username = ${?ELASTIC_USERNAME}
  password = "admin"
  password = ${?ELASTIC_PASSWORD}
  allowInsecure = true
}

annette {
  kafka {
    indexTopic = ${?KAFKA_ATTRIBUTE_INDEX_TOPIC_PREFIX}index_events
    indexTopic = ${?KAFKA_ATTRIBUTE_INDEX_TOPIC}
  }
}

annette.discovery.services  {
  kafka_native = "tcp://localhost:9092"
  kafka_native = ${?KAFKA_URL}
}

cassandra.default {
  ## list the contact points here
  contact-points = "localhost:9042"
  contact-points = ${?CASSANDRA_URL}
  ## keyspace name
  keyspace = ${?KEYSPACE_PREFIX}attributes
  keyspace = ${?KEYSPACE}
  ## authentication
  authentication {
    username = "cassandra"
    username = ${?CASSANDRA_USERNAME}
    password = "cassandra"
    password = ${?CASSANDRA_PASSWORD}
  }

  ## override Lagomâ€™s ServiceLocator-based ConfigSessionProvider
  session-provider = akka.persistence.cassandra.ConfigSessionProvider
  replication-factor = ${?CASSANDRA_REPLICATION_FACTOR}
}

cassandra-journal = ${cassandra.default}
cassandra-snapshot-store = ${cassandra.default}

lagom.persistence {
  read-side.cassandra = ${cassandra.default}
  snapshot-after = 100
  passivate-after-idle-timeout = 300s
}

# for debug purposes
cassandra-journal.events-by-tag.flush-interval = 100ms
cassandra-query-journal.events-by-tag.eventual-consistency-delay = 100ms
cassandra-query-journal.refresh-interval = 100ms

play.http.secret.key = ${?SECRET_KEY}
